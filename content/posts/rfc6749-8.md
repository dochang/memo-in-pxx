---
title: "OAuth 2.0 授权框架 8"
date: 2020-11-04T18:49:00+08:00
categories: [oauth2]
tags: [RFC, 翻译]
draft: false
---

翻译了 [RFC6749] 关于 OAuth 2.0 授权框架规范第 1 章的内容。

<!--more-->

# 1. 介绍

## 1.5. 刷新令牌

刷新令牌是用于获取访问令牌的凭证。刷新令牌由授权服务器发放给客户端。客户端可以在现有的访问令牌失效、过期时使用刷新令牌获取新的访问令牌。也可以使用刷新令牌获取一个作用范围相同或更严格的另一个访问令牌（访问令牌的生存期和权限可以比资源所有者授权的范围更严格）。发放刷新令牌是可选的，是否发放由授权服务器决定。如果授权服务器发放刷新令牌，则与访问令牌一起发放。

刷新令牌是一个字符串，表示了资源所有者对客户端的授权许可，内容通常对客户端不透明。刷新令牌表示一个用来获取授权信息的标识符。与访问令牌不同的是，刷新令牌只用于授权服务器并且永远不会发送到资源服务器。

下图描述了刷新一个过期访问令牌的流程：

```plaintext
  +--------+                                           +---------------+
  |        |--(A)------- Authorization Grant --------->|               |
  |        |                                           |               |
  |        |<-(B)----------- Access Token -------------|               |
  |        |               & Refresh Token             |               |
  |        |                                           |               |
  |        |                            +----------+   |               |
  |        |--(C)---- Access Token ---->|          |   |               |
  |        |                            |          |   |               |
  |        |<-(D)- Protected Resource --| Resource |   | Authorization |
  | Client |                            |  Server  |   |     Server    |
  |        |--(E)---- Access Token ---->|          |   |               |
  |        |                            |          |   |               |
  |        |<-(F)- Invalid Token Error -|          |   |               |
  |        |                            +----------+   |               |
  |        |                                           |               |
  |        |--(G)----------- Refresh Token ----------->|               |
  |        |                                           |               |
  |        |<-(H)----------- Access Token -------------|               |
  +--------+           & Optional Refresh Token        +---------------+
```

 1. 客户端通过向授权服务器认证并提交授权许可来请求一个访问令牌。

 2. 授权服务器认证客户端并验证授权许可，如果有效，发放访问令牌和刷新令牌。

 3. 客户端向资源服务器提交访问令牌，请求受保护资源。

 4. 资源服务器验证访问令牌，如果有效，响应请求。

 5. 重复步骤 3 和 4 直至访问令牌过期。如果客户端知道访问令牌过期，则跳转步骤 7 ；否则，再次请求受保护资源。

 6. 因为访问令牌无效，资源服务器返回一个无效访问令牌的错误。

 7. 客户端通过向授权服务器认证并提交刷新令牌来请求一个新的访问令牌。对客户端的认证要求基于客户端类型和授权服务器的策略。

 8. 授权服务器认证客户端并验证刷新令牌，如果有效，发放一个新的访问令牌（可选地，发放一个新的刷新令牌）。

步骤 3, 4, 5, 6 的内容，如第 7 章所言，超出了本规范的范围。

[RFC6749]: https://tools.ietf.org/html/rfc6749
